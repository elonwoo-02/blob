---
import BaseLayout from '../layouts/BaseLayout.astro';

const pageTitle = '';

const memoCards = [
  {
    time: '2026-01-19 20:33:59',
    tag: '#Diary/Records',
    content: '胖老姨收了几万块贿赂，官方进行了诱供。',
  },
  {
    time: '2026-01-11 02:22:27',
    tag: '#Diary/Dreams',
    content: '梦到算法考试后，和朋友们出去玩，各位朋友好久没见，后来变成恐怖片。',
  },
  {
    time: '2026-01-10 06:02:56',
    tag: '#Diary/Dreams',
    content: '梦到制作的人工智能，藏在松青小屋的柜子里，那是她抱着她数据安全和格式化的地方，外表是我的妹妹。',
  },
  {
    time: '2026-01-09 10:02:04',
    tag: '#Diary/Thought',
    content: '思考：在近代帝国主义进行商品倾销的情况下，抵制外货具有重要作用；但在当下全球化和国际分工的历史背景下，全球贸易使每一个参与者互利共赢，抵制外货的作用减少。',
  },
  {
    time: '2026-01-09 09:46:18',
    tag: '#Diary/Notes',
    content: '党史学习',
  },
];

const heatmap = Array.from({ length: 10 * 7 }, (_, index) => {
  const level = [0, 0, 0, 1, 1, 2, 3][index % 7];

  return {
    id: index,
    level,
  };
});
---

<BaseLayout pageTitle={pageTitle} mainClass="pt-2 md:pt-2">
  <section class="flomo-page mx-auto min-h-[calc(100vh-9rem)] max-w-[1320px] overflow-hidden rounded-[28px] bg-[#f5f5f5] text-[#3f3f46]">
    <header class="flex items-center justify-between border-b border-[#ebebeb] px-6 py-5">
      <div class="flex items-center gap-4">
        <button
          id="sidebar-toggle"
          type="button"
          aria-label="切换侧边栏"
          aria-expanded="true"
          class="grid h-10 w-10 place-items-center rounded-xl text-[#8b8b90] transition hover:bg-white"
        >
          <svg viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="1.8">
            <rect x="3" y="4" width="18" height="16" rx="2" />
            <path d="M9 4v16" />
          </svg>
        </button>
      </div>
      <div class="text-[44px] leading-none text-[#98989f]">···</div>
      <div class="flex items-center gap-4 text-[#8b8b90]">
        <h2 class="text-[48px] font-semibold text-[#323238]">#Diary</h2>
        <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2">
          <path d="m6 9 6 6 6-6" />
        </svg>
      </div>
      <button type="button" class="grid h-10 w-10 place-items-center rounded-xl text-[#8b8b90] transition hover:bg-white" aria-label="搜索">
        <svg viewBox="0 0 24 24" class="h-6 w-6" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="7" />
          <path d="m21 21-4.35-4.35" />
        </svg>
      </button>
    </header>

    <div class="relative flex min-h-[calc(100vh-14rem)]">
      <aside id="sidebar" class="sidebar-panel w-[360px] shrink-0 border-r border-[#ececec] bg-[#f7f7f7] px-8 py-6">
        <h3 class="mb-4 text-5xl font-semibold tracking-tight text-[#3d3d43]">温雅小公子</h3>
        <div class="mb-8 grid grid-cols-3 gap-4 text-[#7a7a80]">
          <div><p class="text-5xl font-semibold text-[#66666d]">1602</p><p class="text-xs uppercase">Memo</p></div>
          <div><p class="text-5xl font-semibold text-[#66666d]">60</p><p class="text-xs uppercase">Tag</p></div>
          <div><p class="text-5xl font-semibold text-[#66666d]">1543</p><p class="text-xs uppercase">Day</p></div>
        </div>
        <div class="mb-8 grid grid-cols-10 gap-2">
          {heatmap.map((cell) => (
            <span
              class:list={[
                'h-4 w-4 rounded-[4px]',
                cell.level === 0 && 'bg-[#e8e8e9]',
                cell.level === 1 && 'bg-[#d0e7da]',
                cell.level === 2 && 'bg-[#b6e5ca]',
                cell.level === 3 && 'bg-[#34d07f]',
              ]}
            ></span>
          ))}
        </div>
        <nav class="space-y-3 text-[30px] text-[#4a4a51]">
          <a href="#" class="block rounded-2xl bg-[#31cd76] px-5 py-3 font-semibold text-white"># Diary</a>
          <a href="#" class="block rounded-2xl px-5 py-3 transition hover:bg-white">MEMO</a>
          <a href="#" class="block rounded-2xl px-5 py-3 transition hover:bg-white">Daily Review</a>
          <a href="#" class="block rounded-2xl px-5 py-3 transition hover:bg-white">AI Insights</a>
        </nav>
      </aside>

      <main class="flex-1 overflow-y-auto px-8 py-6">
        <div class="space-y-5">
          {memoCards.map((card) => (
            <article class="rounded-3xl bg-[#f9f9f9] px-6 py-5 shadow-[0_1px_0_0_#ececec]">
              <div class="mb-3 flex items-center justify-between">
                <p class="text-[28px] text-[#a0a0a8]">{card.time}</p>
                <span class="text-[34px] leading-none text-[#9d9da4]">···</span>
              </div>
              <span class="inline-flex rounded-xl bg-[#e8eefb] px-3 py-1 text-[25px] text-[#7393cd]">{card.tag}</span>
              <p class="mt-4 text-[34px] leading-[1.55] text-[#4a4a4f]">{card.content}</p>
            </article>
          ))}
        </div>
      </main>

      <button
        id="reopen-sidebar"
        type="button"
        class="hidden absolute right-6 top-1/2 grid h-16 w-16 -translate-y-1/2 place-items-center rounded-2xl border border-[#d8d8d8] bg-white text-[#31cd76] shadow-sm"
        aria-label="展开侧边栏"
      >
        <svg viewBox="0 0 24 24" class="h-8 w-8" fill="none" stroke="currentColor" stroke-width="2.2">
          <path d="M4 7h16M4 12h16M4 17h16" />
        </svg>
      </button>

      <button
        type="button"
        class="absolute bottom-7 right-7 grid h-20 w-20 place-items-center rounded-3xl bg-[#31cd76] text-[56px] leading-none text-white shadow-lg"
        aria-label="新增"
      >
        +
      </button>
    </div>
  </section>

  <script>
    const toggleButton = document.getElementById('sidebar-toggle');
    const sidebar = document.getElementById('sidebar');
    const reopenButton = document.getElementById('reopen-sidebar');

    if (toggleButton && sidebar && reopenButton) {
      const closeSidebar = () => {
        sidebar.classList.add('hidden');
        reopenButton.classList.remove('hidden');
        toggleButton.setAttribute('aria-expanded', 'false');
      };

      const openSidebar = () => {
        sidebar.classList.remove('hidden');
        reopenButton.classList.add('hidden');
        toggleButton.setAttribute('aria-expanded', 'true');
      };

      toggleButton.addEventListener('click', closeSidebar);
      reopenButton.addEventListener('click', openSidebar);
    }
  </script>
</BaseLayout>

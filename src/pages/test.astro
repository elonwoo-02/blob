---
import BaseLayout from '../layouts/BaseLayout.astro';

const cards = [
  {
    id: '01',
    title: '今天的随手记',
    content: '把复杂任务拆成可执行的小步骤，情绪会稳定很多。先做 10 分钟，再决定要不要继续。',
    tag: '#效率',
    time: '2 分钟前',
  },
  {
    id: '02',
    title: '产品灵感',
    content: '如果一个功能需要解释三遍，可能不是用户笨，而是入口和反馈设计得还不够直观。',
    tag: '#产品',
    time: '16 分钟前',
  },
  {
    id: '03',
    title: '阅读摘录',
    content: '“持续行动的关键不是自律，而是降低开始的阻力。” 可以给每个计划都配一个 30 秒启动动作。',
    tag: '#阅读',
    time: '今天 09:32',
  },
  {
    id: '04',
    title: '复盘',
    content: '下午的深度工作被消息打断了 5 次。明天尝试 45 分钟专注 + 10 分钟回复的节奏。',
    tag: '#复盘',
    time: '昨天',
  },
  {
    id: '05',
    title: '待办提醒',
    content: '周五前完成 onboarding 文档第一版，重点写清楚权限申请和常见故障排查路径。',
    tag: '#工作',
    time: '昨天',
  },
];
---

<BaseLayout>
  <section class="min-h-[calc(100vh-6rem)] py-6">
    <div id="flomo-mock" class="flex min-h-[75vh] rounded-3xl bg-base-100/90">
      <aside
        id="drawer-panel"
        class="w-64 shrink-0 overflow-hidden rounded-3xl bg-base-100 transition-all duration-300 ease-out"
      >
        <div class="flex h-full flex-col px-4 py-5">
          <div class="mb-6 flex items-center justify-between">
            <h2 class="text-lg font-semibold text-base-content">Memo</h2>
            <button
              id="drawer-toggle"
              type="button"
              class="inline-flex h-9 w-9 items-center justify-center rounded-full bg-black text-white transition hover:opacity-85"
              aria-label="收起导航"
              aria-expanded="true"
            >
              <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />
              </svg>
            </button>
          </div>
          <nav class="space-y-2 text-sm text-base-content/80">
            <a class="block rounded-xl bg-base-200 px-3 py-2 font-medium text-base-content" href="#">全部卡片</a>
            <a class="block rounded-xl px-3 py-2 hover:bg-base-200" href="#">稍后阅读</a>
            <a class="block rounded-xl px-3 py-2 hover:bg-base-200" href="#">标签</a>
            <a class="block rounded-xl px-3 py-2 hover:bg-base-200" href="#">回收站</a>
          </nav>
          <div class="mt-8 rounded-2xl border border-base-300 p-3 text-xs text-base-content/60">
            导航区与背景同色，收起后不会遮盖卡片区，只会给卡片区释放空间。
          </div>
        </div>
      </aside>

      <div class="flex min-w-0 flex-1 flex-col">
        <div class="mb-4 flex items-center gap-3 px-1">
          <button
            id="drawer-open"
            type="button"
            class="hidden h-9 w-9 items-center justify-center rounded-full bg-black text-white transition hover:opacity-85"
            aria-label="展开导航"
          >
            <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
            </svg>
          </button>
          <div>
            <h1 class="text-xl font-semibold text-base-content">今天</h1>
            <p class="text-sm text-base-content/60">Flomo 风格卡片流示例</p>
          </div>
        </div>

        <div class="grid gap-4 sm:grid-cols-2 xl:grid-cols-3">
          {cards.map((card) => (
            <article class="rounded-2xl border border-base-300 bg-base-100 p-4 shadow-sm">
              <div class="mb-3 flex items-center justify-between text-xs text-base-content/50">
                <span>{card.time}</span>
                <span>{card.id}</span>
              </div>
              <h3 class="mb-2 text-base font-semibold text-base-content">{card.title}</h3>
              <p class="mb-4 text-sm leading-6 text-base-content/80">{card.content}</p>
              <span class="inline-flex rounded-full bg-base-200 px-2.5 py-1 text-xs text-base-content/70">{card.tag}</span>
            </article>
          ))}
        </div>
      </div>
    </div>
  </section>

  <script>
    const root = document.getElementById('flomo-mock');
    const panel = document.getElementById('drawer-panel');
    const toggle = document.getElementById('drawer-toggle');
    const openBtn = document.getElementById('drawer-open');

    if (root && panel && toggle && openBtn) {
      const closeDrawer = () => {
        panel.classList.add('w-0');
        panel.classList.remove('w-64');
        openBtn.classList.remove('hidden');
        openBtn.classList.add('inline-flex');
        toggle.setAttribute('aria-expanded', 'false');
      };

      const openDrawer = () => {
        panel.classList.remove('w-0');
        panel.classList.add('w-64');
        openBtn.classList.add('hidden');
        openBtn.classList.remove('inline-flex');
        toggle.setAttribute('aria-expanded', 'true');
      };

      toggle.addEventListener('click', closeDrawer);
      openBtn.addEventListener('click', openDrawer);
    }
  </script>
</BaseLayout>

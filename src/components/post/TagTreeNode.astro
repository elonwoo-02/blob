---
import type { TagNode } from '../../utils/tags';

interface Props {
  node: TagNode;
}

const { node } = Astro.props;
---

<li>
  <div class="flex items-center gap-2 rounded-xl border border-base-300 px-3 py-2 text-sm transition hover:border-primary/40 hover:bg-primary/5">
    {node.children.length > 0 ? (
      <button
        type="button"
        class="tag-toggle inline-flex h-5 w-5 items-center justify-center rounded-md text-xs text-base-content/70 transition hover:bg-base-200"
        data-expanded="true"
        aria-expanded="true"
        aria-label={`收起 ${node.name}`}
      >
        ▾
      </button>
    ) : (
      <span class="inline-flex h-5 w-5 items-center justify-center text-base-content/30">•</span>
    )}

    <button
      type="button"
      class="tag-filter-btn tag-nav-btn flex-1 text-left font-medium"
      data-tag={node.name}
      data-tag-slug={node.slug}
    >
      #{node.name}
    </button>
    <span class="badge badge-ghost badge-sm">{node.count}</span>
  </div>

  {node.children.length > 0 && (
    <ul class="tag-children mt-2 space-y-2 pl-4">
      {node.children.map((child: TagNode) => <Astro.self node={child} />)}
    </ul>
  )}
</li>
